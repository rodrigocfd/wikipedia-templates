<html>
<head>
<meta charset="UTF-8"/>
<meta name="author" content="Rodrigo César de Freitas Dias"/>
<link rel="icon" href="favicon.ico"/>
<title>Citar web</title>
<link type="text/css" rel="stylesheet" href="dress.css"/>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="util.js"></script>
<script>
$(document).ready(function() {
	$('#prever').click(function() {
		$('iframe').show();
		var url = $('input[name=url]').val();
		if (url.length > 0) {
			$('iframe').attr('src', url);
		}
		$('input[name=titulo]').focus();
	});

	$('form').submit(function() {
		function optx(txt, field) {
			var text = $('input[name=' + txt + ']').val();
			return (text.length > 0) ? ' |%s=%s'.format(field, text) : '';
		}

		function optdt(fieldPrefix, field) {
			var d = $('input[name=' + fieldPrefix + 'd]').val();
			var m = $('input[name=' + fieldPrefix + 'm]').val();
			var y = $('input[name=' + fieldPrefix + 'y]').val();
			if (d.length > 0 && m.length > 0 && y.length > 0) {
				return ' |%s=%d de %s de %d'.format(
					field, d,
					['', 'janeiro', 'fevereiro', 'março', 'abril', 'maio', 'junho', 'julho',
						'agosto', 'setembro', 'outubro', 'novembro', 'dezembro'][m],
					y);
			}
			return '';
		}

		var refname = $('input[name=refname]').val();
		if (refname.length > 0) {
			refname = ' name="%s"'.format(refname);
		}

		var out = '<ref' + refname + '>{{Citar web' +
			optx('url', 'url') +
			optx('titulo', 'título') +
			optx('fonte', 'publicado') +
			optdt('data', 'data') +
			optdt('acessado', 'acessodata');

		if ($('input[name=idioma]:checked').val() !== '') {
			out += ' |lingua2=%s'.format( $('input[name=idioma]:checked').val() );
		}

		out += '}}</ref>';

		$('#output')
			.text(out)
			.show()
			.focus()
			.select();
		return false;
	});

	$('input[value=Limpar]').click(function() {
		function putToday(fieldPrefix) {
			var today = new Date();
			$('input[name=' + fieldPrefix + 'd]').val(today.getDate());
			$('input[name=' + fieldPrefix + 'm]').val(today.getMonth() + 1);
			$('input[name=' + fieldPrefix + 'y]').val(today.getFullYear());
		}

		$('input[type=text]').val('');
		putToday('data');
		putToday('acessado');
		$('#output').text('').hide();
		$('iframe').attr('src', '').hide();
		$('input[name=idioma]:first').prop('checked', true);
		$('input[name=url]').focus();
	});

	$('input[value=Limpar]').trigger('click');
});
</script>
</head>

<body>
	<h2>predefinição:Citar web</h2>

	<form>
		<table>
			<tr><td>Ref name</td>
				<td><input type="text" name="refname" size="13"/></td>
			</tr>
			<tr><td>URL</td>
				<td><input type="text" name="url" style="font:12pt arial;" size="90"/>
					<input type="button" id="prever" value="Prever"/></td>
			</tr>
			<tr><td>Título</td>
				<td><input type="text" name="titulo" size="90"/></td>
			</tr>
			<tr><td>Fonte</td>
				<td><input type="text" name="fonte" size="24"/></td>
			</tr>
			<tr><td>Data</td>
				<td><input type="text" name="datad" size="2"/>
					<input type="text" name="datam" size="2"/>
					<input type="text" name="datay" size="4"/>
					&nbsp; acesso <input type="text" name="acessadod" size="2"/>
					<input type="text" name="acessadom" size="2"/>
					<input type="text" name="acessadoy" size="4"/></td>
			</tr>
			<tr><td style="padding: 10px 0;">Idioma</td>
				<td><label><input type="radio" name="idioma" value="" checked="checked"/>nenhum</label>
					<label><input type="radio" name="idioma" value="de"/>alemão</label>
					<label><input type="radio" name="idioma" value="es"/>espanhol</label>
					<label><input type="radio" name="idioma" value="fr"/>francês</label>
					<label><input type="radio" name="idioma" value="en"/>inglês</label>
					<label><input type="radio" name="idioma" value="pt"/>português</label></td>
			</tr>
		</table>

		<input type="submit" value="Montar"/>
		<input type="button" value="Limpar"/>
	</form>

	<textarea id="output" rows="4" cols="100"></textarea>

	<iframe src="" width="100%" height="500"></iframe>

	<p><a href="index.html">voltar</a> |
		<a href="https://pt.wikipedia.org/wiki/Predefini%C3%A7%C3%A3o:Citar_web">docs</a>
	</p>
</body>
</html>