<html ng-app="infoAlbumApp">
<head>
	<meta charset="utf-8"/>
	<meta name="author" content="Rodrigo César de Freitas Dias"/>
	<link rel="icon" href="favicon.ico"/>
	<title>Info/Álbum</title>
	<link type="text/css" rel="stylesheet" href="dress.css"/>
	<style type="text/css">
	.radioCell { padding:6px 0; max-width:400px; }
	.radioCell > div { display:inline-block; }
	.out { font:11pt monospace; border:1px solid #ddd; padding:8px; min-width:460px; cursor:text; }
	.out > div { white-space:pre; }
	</style>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.6/angular.min.js"></script>
	<script>
	var infoAlbumApp = angular.module('infoAlbumApp', []);

	infoAlbumApp.filter('wikilnk', function() {
		return function(s) {
			return s ? '[[' + s + ']]' : '';
		}
	});

	infoAlbumApp.controller('infoAlbumController', function($scope) {
		$scope.tipos = ['estúdio', 'demo', 'ep', 'ao vivo', 'grandes êxitos', 'remistura',
			'caixa', 'compilação', 'mixtape', 'banda sonora', 'vídeo', 'outro'];
		$scope.tipo = 'estúdio';

		$scope.$watch('[lancadoD, lancadoM, lancadoY]', function() {
			$scope.lancadoFin = dmyGet($scope.lancadoD, $scope.lancadoM, $scope.lancadoY);
		});
		$scope.$watch('[gravadoD, gravadoM, gravadoY]', function() {
			$scope.gravadoFin = dmyGet($scope.gravadoD, $scope.gravadoM, $scope.gravadoY);
		});

		$scope.$watch('[duracaoM, duracaoS]', function() {
			$scope.duracaoFin = duracaoGet($scope.duracaoM, $scope.duracaoS);
		});

		$scope.idiomas = [ ['', '(nenhum)'],
			['[[Língua inglesa|inglês]]', 'inglês'],
			['[[Língua portuguesa|português]]', 'português'] ];
		$scope.idioma = '';

		$scope.$watch('[ultimoAlbum, ultimoAlbumAno]', function() {
			$scope.ultimoAlbumFin = albumGet($scope.ultimoAlbum, $scope.ultimoAlbumAno);
		});
		$scope.$watch('[proximoAlbum, proximoAlbumAno]', function() {
			$scope.proximoAlbumFin = albumGet($scope.proximoAlbum, $scope.proximoAlbumAno);
		});
	});

	function dmyGet(d, m, y) {
		if (d || m || y) {
			return '{{Data de início' +
				'|' + (y ? y : '') +
				'|' + (m ? m : '') +
				'|' + (d ? d : '') + '}}';
		}
		return '';
	}

	function duracaoGet(min, sec) {
		if (min && sec) {
			return '{{Duração|m=' + min + '|s=' + sec + '}}';
		} else if (min) {
			return '{{Duração|m=' + min + '|s=0}}';
		} else if (sec) {
			return '{{Duração|m=0|s=' + sec + '}}';
		}
		return '';
	}

	function albumGet(alb, ano) {
		if (alb && ano) {
			return "''[[" + alb + "]]''<br/>([[" + ano + ']])';
		} else if (alb) {
			return "''[[" + alb + "]]''";
		}
		return '';
	}
	</script>
</head>
<body ng-controller="infoAlbumController">
	<h2>Info/Álbum</h2>
	<table>
		<tr><td valign="top">
			<!-- Formulário de preenchimento -->
			<table>
				<tr><td>Nome</td>
					<td><input type="text" ng-model="nome" size="30" autofocus/></td></tr>
				<tr><td>Tipo</td>
					<td class="radioCell">
						<div ng-repeat="t in tipos">
							<label><input type="radio" name="tipo" ng-model="$parent.tipo" value="{{t}}"/>{{t}}</label>
						</div>
					</td></tr>
				<tr><td>Artista</td>
					<td><input type="text" ng-model="artista" size="30"/></td></tr>
				<tr><td>Lançado em</td>
					<td><input type="text" ng-model="lancadoD" size="2"/> /
						<input type="text" ng-model="lancadoM" size="2"/> /
						<input type="text" ng-model="lancadoY" size="4"/></td></tr>
				<tr><td>Gravado em</td>
					<td><input type="text" ng-model="gravadoD" size="2"/> /
						<input type="text" ng-model="gravadoM" size="2"/> /
						<input type="text" ng-model="gravadoY" size="4"/></td></tr>
				<tr><td>Estúdio</td>
					<td><input type="text" ng-model="estudio" size="30"></td></tr>
				<tr><td>Gênero</td>
					<td><input type="text" ng-model="genero" size="30"></td></tr>
				<tr><td>Duração</td>
					<td><input type="text" ng-model="duracaoM" size="2"/> :
						<input type="text" ng-model="duracaoS" size="2"/></td></tr>
				<tr><td>Idioma</td>
					<td class="radioCell">
						<div ng-repeat="i in idiomas">
							<label><input type="radio" name="idioma" ng-model="$parent.idioma" value="{{i[0]}}"/>{{i[1]}}</label>
						</div></td></tr>
				<tr><td>Gravadora</td>
					<td><input type="text" ng-model="gravadora" size="30"></td></tr>
				<tr><td>Produtor</td>
					<td><input type="text" ng-model="produtor" size="30"></td></tr>
				<tr><td>Último álbum</td>
					<td><input type="text" ng-model="ultimoAlbum" size="30"> ano
						<input type="text" ng-model="ultimoAlbumAno" size="4"/></td></tr>
				<tr><td>Próximo álbum</td>
					<td><input type="text" ng-model="proximoAlbum" size="30"> ano
						<input type="text" ng-model="proximoAlbumAno" size="4"/></td></tr>
			</table>
		</td><td valign="top">
			<!-- Saída de dados -->
			<div class="out">
				<div ng-non-bindable>{{Info/Álbum</div>
				<div>|nome          = {{nome}}</div>
				<div>|tipo          = {{tipo}}</div>
				<div>|artista       = {{artista | wikilnk}}</div>
				<div>|lançado       = {{lancadoFin}}</div>
				<div>|gravado       = {{gravadoFin}}</div>
				<div>|estúdio       = {{estudio}}</div>
				<div>|gênero        = {{genero}}</div>
				<div>|duração       = {{duracaoFin}}</div>
				<div>|idioma        = {{idioma}}</div>
				<div>|gravadora     = {{gravadora}}</div>
				<div>|produtor      = {{produtor}}</div>
				<div>|último álbum  = {{ultimoAlbumFin}}</div>
				<div>|próximo álbum = {{proximoAlbumFin}}</div>
				<div ng-non-bindable>}}</div>
			</div>
		</td></tr>
	</table>
	<p><a href="index.html">voltar</a> |
		<a href="https://pt.wikipedia.org/wiki/Predefini%C3%A7%C3%A3o:Info/%C3%81lbum">docs</a>
	</p>
</body>
</html>